# Copyright 2021 Michael Penhallegon 
# 
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# 
#     http://www.apache.org/licenses/LICENSE-2.0
# 
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

[tox]
envlist = {py37, py38, py39}-{intergration, unit, done}
indexserver = 
       default = https://pypi.python.org/simple

[testenv]
deps = -rrequirements.txt
       -rrequirements-dev.txt
commands = 
       unit: pytest -k "not intergration" --cov=house_calendar {posargs: test}
       intergration: pytest -k "intergration" {posargs: test}
       done: pytest --cov=house_calendar {posargs: test}
       done: safety check
       done: mypy house_calendar
setenv =
       POSTGRES_URI = postgresql+asyncpg://postgres:postgres@localhost:5432/hc_events
[testenv:web]
commands = 
       web: uvicorn house_calendar.api:app --reload

[pytest]
markers =
       intergration